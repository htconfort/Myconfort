<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Invoice - MYCONFORT</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            font-family: 'Inter', Arial, sans-serif;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #477A0C 0%, #5A8F0F 25%, #3A6A0A 50%, #6BA015 75%, #477A0C 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .content {
            padding: 30px;
        }
        
        .test-buttons {
            margin: 20px 0;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .btn-primary {
            background: #477A0C;
            color: white;
        }
        
        .btn-primary:hover {
            background: #3A6A0A;
            transform: translateY(-2px);
        }
        
        .btn-secondary {
            background: #89BBFE;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #6BA8FD;
            transform: translateY(-2px);
        }
        
        .invoice-preview {
            border: 2px solid #477A0C;
            border-radius: 8px;
            margin: 20px 0;
            overflow: hidden;
        }
    </style>
    <!-- html2pdf.js CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üå∏ MYCONFORT - Test Invoice</h1>
            <p>Test de g√©n√©ration PDF avec votre script exact</p>
        </div>
        
        <div class="content">
            <h2>Test de votre script html2pdf.js</h2>
            <p>Cette page permet de tester la g√©n√©ration PDF avec votre configuration exacte.</p>
            
            <div class="test-buttons">
                <button class="btn btn-primary" onclick="testYourScript()">
                    üìÑ Tester Votre Script Exact
                </button>
                <button class="btn btn-secondary" onclick="testWithDifferentElement()">
                    üß™ Test √âl√©ment Alternatif
                </button>
                <button class="btn btn-primary" onclick="goToMainApp()">
                    üè† Retour √† l'Application
                </button>
            </div>
            
            <!-- Votre facture de test -->
            <div class="invoice-preview">
                <div id="invoice" class="facture-apercu" style="font-family: Arial; padding: 20px; max-width: 600px; margin: auto; background: white;">
                    <h2 style="color:#477A0C;">MYCONFORT - Facture</h2>
                    <p><strong>Date :</strong> 26/06/2025</p>
                    <p><strong>Facture n¬∞ :</strong> 2025-6304</p>
                    <hr style="border: 1px solid #477A0C;" />
                    <p><strong>Client :</strong> Monsieur Dupont</p>
                    <p><strong>Produit :</strong> Matelas Confort</p>
                    <p><strong>Montant TTC :</strong> 299,00 ‚Ç¨</p>
                    <hr style="border: 1px solid #477A0C;" />
                    <p style="text-align: center; color: #477A0C; font-weight: bold;">
                        Merci pour votre confiance üå∏
                    </p>
                </div>
            </div>
            
            <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin: 20px 0;">
                <h3>üìã Instructions de test :</h3>
                <ol>
                    <li><strong>Tester Votre Script Exact</strong> : Utilise votre configuration exacte avec l'√©l√©ment .facture-apercu</li>
                    <li><strong>Test √âl√©ment Alternatif</strong> : Teste avec l'ID #invoice comme fallback</li>
                    <li><strong>Retour √† l'Application</strong> : Revenir √† votre application principale</li>
                </ol>
            </div>
            
            <div style="background: #e8f5e8; padding: 15px; border-radius: 8px; border: 2px solid #477A0C;">
                <h3 style="color: #477A0C;">üéØ Configuration de votre script :</h3>
                <pre style="background: #f8f9fa; padding: 10px; border-radius: 4px; font-size: 12px; overflow-x: auto;">
const opt = {
  margin: 0,
  filename: 'facture_MYCONFORT.pdf',
  html2canvas: { scale: 2, useCORS: true },
  jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
};
html2pdf().set(opt).from(element).save();
                </pre>
            </div>
        </div>
    </div>

    <script>
        // üéØ VOTRE SCRIPT EXACT
        function testYourScript() {
            console.log('üß™ TEST DE VOTRE SCRIPT EXACT');
            
            // Chercher l'√©l√©ment .facture-apercu (votre conteneur exact)
            const element = document.querySelector('.facture-apercu');
            
            if (!element) {
                alert('‚ùå √âl√©ment .facture-apercu non trouv√©');
                return;
            }
            
            // VOTRE CONFIGURATION EXACTE
            const opt = {
                margin: 0,
                filename: 'facture_MYCONFORT.pdf',
                html2canvas: { scale: 2, useCORS: true },
                jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
            };
            
            console.log('üîÑ G√©n√©ration PDF avec votre script exact...');
            
            html2pdf().set(opt).from(element).save().then(() => {
                console.log('‚úÖ PDF g√©n√©r√© avec succ√®s !');
                alert('‚úÖ PDF t√©l√©charg√© avec succ√®s avec votre script exact !');
            }).catch((error) => {
                console.error('‚ùå Erreur g√©n√©ration PDF:', error);
                alert('‚ùå Erreur lors de la g√©n√©ration du PDF');
            });
        }
        
        // üß™ TEST AVEC √âL√âMENT ALTERNATIF
        function testWithDifferentElement() {
            console.log('üß™ TEST AVEC √âL√âMENT ALTERNATIF (#invoice)');
            
            const element = document.getElementById('invoice');
            
            if (!element) {
                alert('‚ùå √âl√©ment #invoice non trouv√©');
                return;
            }
            
            const opt = {
                margin: 0,
                filename: 'test_invoice_alternative.pdf',
                html2canvas: { scale: 2, useCORS: true },
                jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
            };
            
            console.log('üîÑ Test avec √©l√©ment alternatif...');
            
            html2pdf().set(opt).from(element).save().then(() => {
                console.log('‚úÖ PDF alternatif g√©n√©r√© avec succ√®s !');
                alert('‚úÖ PDF alternatif t√©l√©charg√© avec succ√®s !');
            }).catch((error) => {
                console.error('‚ùå Erreur PDF alternatif:', error);
                alert('‚ùå Erreur lors de la g√©n√©ration du PDF alternatif');
            });
        }
        
        // üè† RETOUR √Ä L'APPLICATION PRINCIPALE
        function goToMainApp() {
            window.location.href = '/';
        }
        
        // üìä DIAGNOSTIC AU CHARGEMENT
        window.addEventListener('load', function() {
            console.log('üìä DIAGNOSTIC DES √âL√âMENTS DISPONIBLES :');
            
            const factureApercu = document.querySelector('.facture-apercu');
            const invoiceElement = document.getElementById('invoice');
            
            console.log('üîç √âl√©ment .facture-apercu trouv√© :', !!factureApercu);
            console.log('üîç √âl√©ment #invoice trouv√© :', !!invoiceElement);
            
            if (factureApercu) {
                console.log('üìê Dimensions .facture-apercu :', {
                    width: factureApercu.offsetWidth,
                    height: factureApercu.offsetHeight,
                    scrollWidth: factureApercu.scrollWidth,
                    scrollHeight: factureApercu.scrollHeight
                });
            }
            
            if (invoiceElement) {
                console.log('üìê Dimensions #invoice :', {
                    width: invoiceElement.offsetWidth,
                    height: invoiceElement.offsetHeight,
                    scrollWidth: invoiceElement.scrollWidth,
                    scrollHeight: invoiceElement.scrollHeight
                });
            }
        });
    </script>
</body>
</html>